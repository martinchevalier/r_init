--- 
title: "**Formation R Initiation**"
author: "Martin Chevalier (Insee)"
date: "Version du `r format(Sys.Date(), '%d/%m/%Y')`"
knit: "bookdown::render_book"
site: bookdown::bookdown_site
documentclass: book
classoption: twosided, notitlepage
fontsize: 12pt
geometry: top=2.5cm, bottom=2.5cm, inner=3.5cm, outer=2.5cm
---

```{r setup, include=FALSE}
.download <- FALSE
.sol <- TRUE
knitr::opts_chunk$set(comment = "  ##", collapse = TRUE, fig.path = "../figures/")
options(scipen = 10, stringsAsFactors = TRUE, repos = "https://cran.rstudio.com/")

# Récupération des données 
if(.download){
  file <- tempfile()
  download.file("http://r.slmc.fr/donnees.zip", file)
}else file <- "#output/donnees.zip"
.dir <- tempdir()
unzip(file, exdir = .dir)
knitr::opts_knit$set(root.dir = .dir)

# Chargement des packages (après installation éventuelle)
lapply(c("foreign", "haven", "data.table", "descr", "moments", "Hmisc", "pryr", "microbenchmark"), function(pkg) {
  if (system.file(package = pkg) == "") install.packages(pkg)
  library(pkg, character.only = TRUE)
})


### Sections ----

set.seed(1)
.numHide <- 0
.numQuestion <- 0
.html <<- knitr::opts_knit$get("rmarkdown.pandoc.to") == "html"
.pdf <<- knitr::opts_knit$get("rmarkdown.pandoc.to") == "latex"

.module <- function(numModule, text){
  .numModule <<- numModule
  .numQuestion <<- 0
  if(.html) cat("#", text, sep = "")
  if(.pdf){
    if(.numModule > 1) cat("\\addtocontents{cp}{\\vspace{\\normalbaselineskip}}")
    cat("#", text, "\n \\minitoc \n", sep = "")
  }
  # if(.pdf){
  #   if(.numModule > 1) cat("\\addtocontents{cp}{\\vspace{\\normalbaselineskip}}")
  #   cat("\\chapter{", text, "}", sep = "")
  #   cat("\n \\minitoc \n")
  # }
}

.partie <- function(text){
  if(.html) cat("##", text, sep = "")
  if(.pdf) cat("##", text, "", sep = "")
}

.souspartie <- function(text){
  if(.html) cat("###", text, sep = "")
  if(.pdf) cat("###", text, sep = "")
}

### Fonctions outils ----

# Arrondis
.f <- function(x, digits = 2){
  formatC(as.numeric(x), format = "f", decimal.mark = ",",  big.mark = " ", digits = digits)
}

# Index de fonctions
.fun <- function(fun, bold = FALSE){
  if(.pdf) r <- paste0("\\index{\\texttt{", fun, "}", if(bold) "|textbf" else "",  "}")
  if(.html) r <- ""
  return(r)
}

# Fonction pour garantir la cohérence des références internes
# entre la version web et la version imprimée
.ref <- function(text, link_html = NULL, link_pdf = NULL){
  if(.html & !is.null(link_html)) out <- paste0("[", text, "](", link_html, ")")
  if(.html & is.null(link_html)) out <- paste0(text)
  if(.pdf & !is.null(link_pdf)) out <- paste0("[\\underline{", text, "}](", link_pdf, ")")
  if(.pdf & is.null(link_pdf)) out <- paste0("\\underline{", text, "}")
  return(out)
}


# Introduction d'un cas pratique
.question <- function(text = NULL){
  .numQuestion <<- .numQuestion + 1
  cat("\n"); cat("\\ \n"); cat("\n");
  cat("**Cas pratique ", .numModule, ".", .numQuestion, "** ", text, sep = "")
  if(.pdf) cat(
    "\n \\addcontentsline{cp}{caspratique}{"
    , .numModule, ".", .numQuestion, " ", text
    , "}", sep = ""
  )
  
}

# Solution d'une question
.beginsol <- function(){
  .numHide <<- .numHide + 1
  if(.html){
    cat("<div style = \"text-align: right;\">")
    cat("<button type=\"button\" onclick=\"hide('sol", .numHide, "')\">Afficher/masquer la solution</button>", sep = "")
    cat("</div>")
    cat("<div id='sol", .numHide, "' style=\"display: none; height: 0;\">\n<hr/>", sep = "")
  }
  if(.pdf) cat("\\ifsol \n \\begin{center} \\rule{0.5\\linewidth}{\\linethickness}\\end{center} \n")
}
.endsol <- function(){
  if(.html) cat("\n<hr /></div>\n\n \\ \n \n")
  if(.pdf) cat("  \n  \\begin{center} \\rule{0.5\\linewidth}{\\linethickness}\\end{center} \n \\bigskip \n \\fi \n")
}

# Indication d'une question
.indic <- function(text){
  .numHide <<- .numHide + 1
  if(.html){
    cat("<div style = \"text-align: right;\">")
    cat("<button type=\"button\" onclick=\"hide('sol", .numHide, "');this.style.display='none'\">Indication</button>", sep = "")
    cat("</div>")
    cat("<div id='sol", .numHide, "' style=\"display: none; height: 0;\">\n", sep = "")
    cat(text)
    cat("\n</div>\n\n \\ \n \n")
  }
  if(.pdf){
    cat("\\ifsol \n")
    cat(text)
    cat("\\fi \n")
  }
}

```

# Introduction {-}

```{r, results = "asis", echo = FALSE}
# Pour éviter le décalage des minitoc en début de chapitre
# https://texnique.fr/osqa/questions/5022/minitoc-un-chapitre-en-retard
if(.pdf) cat("\n \\adjustmtc \n")
```


Cette page rassemble les supports de la formation R initiation des 22 et 23 janvier 2018 :

- [Module 1 Prise en main du logiciel (.html)](module1.html)

- [Module 2 Manipuler les outils fondamentaux du langage (.html)](module2.html)

- [Module 3 Travailler avec des données statistiques (.html)](module3.html)

- [Données utilisées pour les cas pratiques (.zip, 3,6 Mo)](donnees.zip)

- [Support de formation en format imprimable (.pdf)](livret.pdf)

- [Support de formation en format imprimable et avec solutions (.pdf)](livret_sol.pdf)

- [Support de présentation utilisé lors de la formation (.pdf)](presentation.pdf)


**Note** Les pages html peuvent être téléchargées sous forme de fichiers .html autonomes et consultées hors connexion.

\ 

Les supports de cette formation ont été conçus sous RStudio avec [R Markdown](http://rmarkdown.rstudio.com/) et compilés le `r format(Sys.Date(), format="%d/%m/%Y")`. Certains éléments de mise en forme du site compagnon sont repris de l'ouvrage [R packages](http://r-pkgs.had.co.nz/) de Hadley Wickham. 
  
Ces supports seront durablement disponibles à l'adresse [http://   r.slmc.fr](http://r.slmc.fr/) et leur code source sur [github](https://github.com/martinchevalier/r_insee). L'ensemble est librement réutilisable sous &copy;\ 2016-2018 Martin Chevalier [CC BY-NC-SA 3.0](https://creativecommons.org/licenses/by-nc-sa/3.0/fr).

\ 

[Retour à la page d'accueil](..)
